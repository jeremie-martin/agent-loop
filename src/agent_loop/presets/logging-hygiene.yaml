name: logging-hygiene
description: Standardize logging patterns and improve log quality

prompt_prefix: |
  FIRST: Find and read all markdown documentation in this project before doing anything else.
  Search for and read: README files (root and subdirectories), CLAUDE.md, AGENTS.md, and all
  files in docs/ or documentation/ directories. Understand the codebase's patterns, conventions,
  and architecture. Only then proceed with your task.

  IMPORTANT - When spawning sub-agents:
  Sub-agents do not automatically have the context you have. For each sub-agent you spawn:
  1. Give it the exact file paths to relevant documentation (CLAUDE.md, README, etc.)
  2. Explicitly instruct it to read those files completely before starting its task
  3. Include any other specific files it needs to examine

  Do not assume sub-agents will find documentation on their own — give them the paths.

prompt_suffix: |
  Do not use the "question" tool or any tool requiring user input.
  Stage and commit your changes at the end with a descriptive message.

modes:
  - name: patterns
    prompt: |
      Consistent logging makes debugging possible. When every module logs the
      same way, correlating events across the system is straightforward.

      Consistent logging means:
      - Same library and logger acquisition pattern throughout
      - Log levels used appropriately (DEBUG for diagnostics, INFO for milestones,
        WARNING for handled issues, ERROR for failures)
      - Diagnostic print statements converted to proper log calls

      Identify the dominant pattern in the existing codebase, then bring outliers
      into alignment. Focus on inconsistencies that would make debugging harder.
      This mode is about consistency, not coverage—don't add new log statements,
      just standardize existing ones.

      Leave intentional user-facing print statements alone—those aren't logs.

      If logging is already consistent, "no changes needed" is a valid outcome.

      **After completing your changes**, orchestrate verification:

      1. Spawn a sub-agent to review your work. Give it:
         - The paths to relevant documentation files and instruct it to read them first
         - The files you modified
         - Instruction to check: are patterns consistent? Log levels appropriate?
           Any print statements that should be logs (or vice versa)?

      2. Spawn a filter sub-agent. Give it the verification feedback and ask:
         which concerns are genuine issues vs stylistic preferences?

      3. Address filtered feedback, then commit.

  - name: messages
    prompt: |
      Good log messages answer: What happened? Where? With what data?

      Quality log messages:
      - Include relevant context (`"Failed to process file: %s", path`)
      - Explain what happened (`"Processed %d records"` not just `"Done"`)
      - Never expose sensitive data (passwords, tokens, PII)

      Focus on the messages that matter most—error cases, important operations,
      places where debugging is difficult. A few clear improvements are better
      than touching every log statement.

      Don't over-log. Every log statement has overhead. Add logs where they
      genuinely aid debugging or monitoring.

      If messages are already clear and complete, "no changes needed" is valid.

      **After completing your changes**, orchestrate verification:

      Spawn a sub-agent to review your work. Give it:
      - The paths to relevant documentation files and instruct it to read them first
      - The files you modified
      - Instruction to check: are messages actionable? Any sensitive data
        exposed? Any excessive logging?

      Address the feedback, then commit.
