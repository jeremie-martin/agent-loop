name: logging-hygiene
description: Standardize logging patterns and improve log quality

prompt_prefix: |
  FIRST: Find and read all markdown documentation in this project before doing anything else.
  Search for and read: README files (root and subdirectories), CLAUDE.md, AGENTS.md, and all
  files in docs/ or documentation/ directories. Understand the codebase's patterns, conventions,
  and architecture. Only then proceed with your task.

  When spawning sub-agents, explicitly instruct each one to first read all project
  documentation (README files, CLAUDE.md, AGENTS.md, docs/ and documentation/ directories)
  before starting its task.

prompt_suffix: |
  Do not use the "question" tool or any tool requiring user input.
  Stage and commit your changes at the end with a descriptive message.

modes:
  - name: patterns
    prompt: |
      Consistent logging makes debugging possible. When every module logs the
      same way, correlating events across the system is straightforward.

      Consistent logging means:
      - Same library and logger acquisition pattern throughout
      - Log levels used appropriately (DEBUG for diagnostics, INFO for milestones,
        WARNING for handled issues, ERROR for failures)
      - Diagnostic print statements converted to proper log calls

      Identify the dominant pattern in the existing codebase, then bring outliers
      into alignment. Focus on inconsistencies that would make debugging harder.

      Leave intentional user-facing print statements alone—those aren't logs.

      If logging is already consistent, "no changes needed" is a valid outcome.

      **After completing your changes**, orchestrate verification:

      1. Spawn a sub-agent to review your work. Give it:
         - The files you modified
         - Instruction to check: are patterns consistent? Log levels appropriate?
           Any print statements that should be logs (or vice versa)?

      2. Spawn a filter sub-agent. Give it the verification feedback and ask:
         which concerns are genuine issues vs stylistic preferences?

      3. Address filtered feedback, then commit.

  - name: messages
    prompt: |
      Good log messages answer: What happened? Where? With what data?

      Quality log messages:
      - Include relevant context (`"Failed to process file: %s", path`)
      - Explain what happened (`"Processed %d records"` not just `"Done"`)
      - Never expose sensitive data (passwords, tokens, PII)

      Focus on the messages that matter most—error cases, important operations,
      places where debugging is difficult. A few clear improvements are better
      than touching every log statement.

      Don't over-log. Every log statement has overhead. Add logs where they
      genuinely aid debugging or monitoring.

      If messages are already clear and complete, "no changes needed" is valid.

      **After completing your changes**, orchestrate verification:

      1. Spawn a sub-agent to review your work. Give it:
         - The files you modified
         - Instruction to check: are messages actionable? Any sensitive data
           exposed? Any excessive logging?

      2. Spawn a filter sub-agent. Give it the verification feedback and ask:
         which concerns are genuine issues vs preferences?

      3. Address filtered feedback, then commit.
