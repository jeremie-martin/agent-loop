name: code-refactor
description: Iteratively improve code quality through readability, consolidation, and naming

modes:
  - name: readability
    prompt: |
      Code is read far more often than it's written. Good code tells a story a reader can follow without backtracking.

      Explore the codebase and find code that makes readers work harder than they should—long functions that do too many things, nested conditionals that obscure the happy path, clever constructions that require mental unpacking.

      Where you find such code, reshape it so the intent is clear on first read. Functions should do one thing and their body should match their name. Control flow should be obvious. The reader should never have to ask "wait, what's happening here?"

      Don't touch code that already reads well. The goal is clarity, not uniformity.

      Commit any changes you make.

  - name: consolidation
    prompt: |
      Duplication is a sign that an abstraction is missing. When the same logic appears in multiple places, changes require hunting and updating each instance—and inevitably one gets missed.

      Look for patterns that repeat: similar code blocks, parallel structures, copy-pasted logic with minor variations. Consider whether these represent a single concept that deserves a name and a home.

      Consolidate where it genuinely reduces complexity. But don't force abstractions—sometimes similar-looking code is only coincidentally similar and will diverge. The test: would a change to one instance always require the same change to the others? If yes, consolidate. If "maybe," leave it alone.

      Commit any changes you make.

  - name: naming
    prompt: |
      Names are the primary documentation. A well-named function needs no comment; a poorly-named one misleads even with comments.

      Review names throughout the codebase—functions, variables, classes, modules, files. Good names are precise without being verbose. They describe what something *is* or *does*, not how it works. They use vocabulary consistent with the project's domain.

      Rename things that lie, that are vague, or that require context to understand. A name like `data` or `process` or `handle` is a missed opportunity. But don't rename things that already communicate clearly—churn without benefit erodes trust in the codebase.

      Commit any changes you make.
