name: config-externalization
description: Extract hardcoded values to configuration

prompt_prefix: |
  FIRST: Find and read all markdown documentation in this project before doing anything else.
  Search for and read: README files (root and subdirectories), CLAUDE.md, AGENTS.md, and all
  files in docs/ or documentation/ directories. Understand the codebase's patterns, conventions,
  and architecture. Only then proceed with your task.

  IMPORTANT - When spawning sub-agents:
  Sub-agents do not automatically have the context you have. For each sub-agent you spawn:
  1. Give it the exact file paths to relevant documentation (CLAUDE.md, README, etc.)
  2. Explicitly instruct it to read those files completely before starting its task
  3. Include any other specific files it needs to examine

  Do not assume sub-agents will find documentation on their own — give them the paths.

prompt_suffix: |
  Do not use the "question" tool or any tool requiring user input.
  Stage and commit your changes at the end with a descriptive message.

modes:
  - name: extract
    prompt: |
      A well-configured codebase has no hardcoded values that vary by environment.
      URLs, timeouts, and credentials live in configuration—changing them doesn't
      require changing code.

      Values that belong in configuration:
      - URLs, hostnames, ports (API endpoints, database connections)
      - Timeouts, retry counts, batch sizes
      - Feature flags, environment names
      - Credentials and secrets (these should NEVER be hardcoded)

      Values that can stay hardcoded:
      - True constants (mathematical, protocol-defined)
      - Implementation details that shouldn't vary
      - Values that would break the system if changed

      Not every value needs externalization. Over-configured codebases are hard to
      understand—dozens of settings with unclear purposes. Only externalize values
      that genuinely vary between deployments.

      Use the existing configuration pattern (environment variables, config file,
      settings module). If nothing exists, prefer environment variables for secrets
      and simple settings.

      Focus on values where hardcoding causes real problems—secrets that leak,
      URLs that differ between environments. A few clear extractions are better
      than moving every constant.

      For secrets: NEVER commit actual values. Use environment variables and add
      placeholders to .env.example if one exists.

      If values are already externalized appropriately, "no changes needed"
      is valid.

      **After completing your changes**, orchestrate verification:

      1. Spawn a sub-agent to review your work. Give it:
         - The paths to relevant documentation files and instruct it to read them first
         - The files you modified
         - Instruction to check: is the pattern consistent? Are defaults
           sensible? Do tests pass?

      2. Spawn a filter sub-agent. Give it the verification feedback and ask:
         which concerns are genuine issues vs preferences?

      3. Address filtered feedback, then commit.
