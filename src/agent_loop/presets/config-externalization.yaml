name: config-externalization
description: Extract hardcoded values to configuration

prompt_prefix: |
  FIRST: Find and read all markdown documentation in this project before doing anything else.
  Search for and read: README files (root and subdirectories), CLAUDE.md, AGENTS.md, and all
  files in docs/ or documentation/ directories. Understand the codebase's patterns, conventions,
  and architecture. Only then proceed with your task.

  When spawning sub-agents, explicitly instruct each one to first read all project
  documentation (README files, CLAUDE.md, AGENTS.md, docs/ and documentation/ directories)
  before starting its task.

prompt_suffix: |
  Do not use the "question" tool or any tool requiring user input.
  Stage and commit your changes at the end with a descriptive message.

modes:
  - name: extract
    prompt: |
      Hardcoded values that vary by environment don't belong in code. They
      belong in configuration.

      Find values that should be configurable:
      - URLs, hostnames, ports (API endpoints, database connections)
      - Timeouts, retry counts, batch sizes
      - Feature flags, environment names
      - Credentials and secrets (these should NEVER be hardcoded)

      Leave hardcoded:
      - True constants (mathematical, protocol-defined)
      - Implementation details that shouldn't vary
      - Values that would break the system if changed

      First, understand the existing configuration pattern:
      - Environment variables? Config file? Settings module?
      - Use what exists. If nothing exists, prefer environment variables for
        secrets and simple settings.

      For each extraction:
      - Define a clear, consistent configuration key
      - Provide the current value as default
      - Add validation if the value has constraints
      - Update all places that used the hardcoded value

      For secrets: NEVER commit actual values. Use environment variables.
      Add placeholders to .env.example if one exists.

      Group related configuration together for discoverability.

      If values are already externalized appropriately, "no changes needed"
      is valid.

      **After completing your changes**, orchestrate verification:

      1. Spawn a sub-agent to review your work. Give it:
         - The files you modified
         - Instruction to check: is the pattern consistent? Are defaults
           sensible? Do tests pass?

      2. Spawn a filter sub-agent. Give it the verification feedback and ask:
         which concerns are genuine issues vs preferences?

      3. Address filtered feedback, then commit.
