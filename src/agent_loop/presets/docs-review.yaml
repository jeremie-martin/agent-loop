name: docs-review
description: Review documentation for quality, accuracy, and coherence
model: zai-coding-plan/glm-4.7

prompt_prefix: |
  Before editing any documentation file, first read the corresponding source code
  to verify current behavior. Cite specific code locations for any factual claims
  you add or modify.

prompt_suffix: |
  Do not commit changes - they will be reviewed and committed at the end of the cycle.
  Do not use the "question" tool or any tool requiring user input.

modes:
  - name: accuracy
    prompt: |
      Review the documentation for factual accuracy against the actual codebase.

      For each documentation file, identify factual claims about:
      - API signatures, parameters, return types
      - Behavior descriptions ("when X happens, Y occurs")
      - Configuration options and their effects

      For each claim, locate the corresponding source code. If you cannot find code that supports a claim, flag it for removal or correction. If terminology doesn't match what the code uses, update it.

      Fix inaccuracies as you find them. Don't just note them—correct them.

  - name: structure
    prompt: |
      Review how the documentation files work together as a navigable system.

      Read through the documentation and assess: Is there a clear entry point? Do documents link to each other in ways that guide readers? Are there files that overlap significantly, or gaps where readers would expect something?

      If restructuring, consolidating, or reshaping would improve navigability, apply those changes. But preserve what already works—don't reorganize documentation that readers can already find their way through.

  - name: clarity
    prompt: |
      Review each documentation file for how well it communicates.

      Clear documentation respects the reader's time: sentences do work, paragraphs have focus, sections don't meander. It uses consistent terminology and speaks in one voice.

      For each file: Does this read well? Are there passages that could be tightened without losing meaning? Is the level of detail appropriate?

      Make edits that improve clarity or tighten prose. Leave alone anything that already communicates effectively—editing for the sake of editing adds churn without value.

review:
  enabled: true
  check_prompt: |
    Review only the documentation changes (markdown files, README, docs/).
    Ignore any unrelated files that may appear in git diff.

    For each modified doc file, verify:
    1. All factual claims are supported by current source code
    2. No accurate content was incorrectly removed
    3. Terminology matches what the code uses

    Read the relevant source files to cross-check claims.

  filter_prompt: |
    Filter out:
    - Stylistic preferences that don't affect accuracy
    - Suggestions to add content beyond the current scope
    - Warnings about things that are actually correct
    - Concerns about files unrelated to documentation

    Only act on genuine accuracy issues in the documentation.
