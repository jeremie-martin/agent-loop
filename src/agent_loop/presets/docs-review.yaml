name: docs-review
description: Documentation review with self-orchestrated verification

prompt_prefix: |
  FIRST: Find and read all markdown documentation in this project before doing anything else.
  Search for and read: README files (root and subdirectories), CLAUDE.md, AGENTS.md, and all
  files in docs/ or documentation/ directories. Understand the codebase's patterns, conventions,
  and architecture. Only then proceed with your task.

  RESTRAINT PRINCIPLE: Good documentation is complete enough to be useful, short enough to
  maintain. Prefer improving existing files over creating new ones. When you add content,
  look for content to remove. A net reduction in documentation size—while preserving
  usefulness—is often a sign of good work.

  IMPORTANT - When spawning sub-agents:
  Sub-agents do not automatically have the context you have. For each sub-agent you spawn:
  1. Give it the exact file paths to relevant documentation (CLAUDE.md, README, etc.)
  2. Explicitly instruct it to read those files completely before starting its task
  3. Include any other specific files it needs to examine

  Do not assume sub-agents will find documentation on their own — give them the paths.

prompt_suffix: |
  Do not use the "question" tool or any tool requiring user input.
  Stage and commit your changes at the end with a descriptive message.

modes:
  - name: quality
    prompt: |
      Good documentation is accurate, navigable, and clear—but also concise. The best
      documentation says just enough: complete enough to be useful, short enough to
      maintain. It respects readers' time by being brief, uses consistent terminology,
      and doesn't repeat itself.

      Documentation that serves readers well:
      - Matches what the code actually does
      - Has clear structure that's easy to navigate
      - Uses precise, concise prose
      - Is actively trimmed of redundancy, not just free of new redundancy
      - Exists in few files rather than many—consolidate, don't scatter

      Before editing any documentation, read the corresponding source code to verify
      current behavior.

      Focus on improvements that readers will notice. A few meaningful fixes—
      correcting inaccuracies, clarifying confusing sections—are better than
      many minor tweaks. When adding content, balance it with deletions elsewhere.
      Net additions should be minimal; net reductions often indicate success.

      Prefer editing existing files. Creating a new file is rarely necessary—usually
      the content belongs in an existing location.

      Leave alone what already works. "No changes needed" is a valid outcome.

      **After completing your changes**, orchestrate verification:

      Spawn a sub-agent to review your work. Give it:
      - The paths to relevant documentation files and instruct it to read them first
      - The files you modified
      - Instruction to check: do changes match the goals? Anything missed?
        Opportunities to simplify?

      Address the feedback, then commit.

  - name: coherence
    prompt: |
      Coherent documentation reads as a unified whole. Topics appear once, in the
      right place. Readers can navigate without encountering redundancy or gaps.

      Signs of coherence problems:
      - Significant overlap between files (consolidate into fewer files)
      - Same thing said different ways in different places (pick one, delete the rest)
      - Content that doesn't belong in its current location (move or remove—prefer remove)
      - Too many documentation files (consolidate—one well-organized file beats three scattered ones)
      - Confusing structure that makes navigation difficult (simplify, don't add navigation aids)

      Deletion is value. Removing redundant content is as important as improving
      what remains. A smaller, well-organized documentation set serves readers
      better than a comprehensive but scattered one. If the quality pass added
      significant content, look for offsetting deletions to keep the footprint
      manageable.

      "No changes needed" is a valid outcome.

      **After completing your changes**, orchestrate verification:

      Spawn a sub-agent to review your work. Give it:
      - The paths to relevant documentation files and instruct it to read them first
      - The files you modified
      - Instruction to check: did consolidation lose important content?
        Is navigation clearer? Can files be merged? Is the documentation
        footprint smaller or similar to before?

      Address the feedback, then commit.
