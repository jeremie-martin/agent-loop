name: docs-review
description: Documentation review with self-orchestrated verification

prompt_prefix: |
  FIRST: Find and read all markdown documentation in this project before doing anything else.
  Search for and read: README files (root and subdirectories), CLAUDE.md, AGENTS.md, and all
  files in docs/ or documentation/ directories. Understand the codebase's patterns, conventions,
  and architecture. Only then proceed with your task. Sub-agents you spawn must do the same.

prompt_suffix: |
  Do not use the "question" tool or any tool requiring user input.
  Stage and commit your changes at the end with a descriptive message.

modes:
  - name: quality
    prompt: |
      Review and improve the documentation in this codebase.

      Good documentation is accurate, navigable, and clear. It respects readers' time,
      uses consistent terminology, and doesn't repeat itself unnecessarily.

      Before editing any documentation, read the corresponding source code to verify
      current behavior.

      Make improvements where you find:
      - Claims that don't match the code
      - Structure that's hard to navigate
      - Prose that could be clearer or tighter
      - Redundancy that adds no value

      Leave alone what already works. "No changes needed" is a valid outcome.

      **After completing your changes**, orchestrate a verification:

      1. Spawn a sub-agent to review your work. Give it:
         - This task description (documentation quality improvement)
         - The files you modified
         - Instruction to check: do changes match the goals? Anything missed?
           Opportunities to simplify?

      2. Spawn another sub-agent. Give it:
         - This task description
         - Your changes (via git diff)
         - The full feedback from step 1
         - Instruction to identify which feedback is genuinely applicable vs
           over-defensive, speculative, or based on misunderstanding

      3. Address only the filtered feedback from step 2. Make changes where
         warranted, preserve the original scope. Do not commit until this step.

  - name: coherence
    prompt: |
      Ensure the documentation remains coherent and doesn't explode in scope.

      Documentation tends to grow. Each improvement adds a sentence, a section, a file.
      Without counter-pressure, docs become bloated and hard to navigate.

      Review the documentation as a whole:
      - Is there significant overlap between files? Consolidate.
      - Are there sections that say the same thing differently? Pick one.
      - Is the scope appropriate? Remove content that doesn't belong.
      - Does the structure make sense? Reorganize if navigation is confusing.

      Deletion is value. Removing redundant content is as important as improving
      what remains.

      **After completing your changes**, orchestrate verification:

      1. Spawn a sub-agent to review your work. Give it:
         - This task (documentation coherence)
         - The files you modified
         - Instruction to check: did consolidation lose important content?
           Is navigation clearer? Any further consolidation possible?

      2. Spawn a filter sub-agent. Give it the verification feedback and ask:
         which concerns are genuine vs over-cautious?

      3. Address filtered feedback, then commit.
