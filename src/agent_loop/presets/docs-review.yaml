name: docs-review
description: Documentation review with self-orchestrated verification

prompt_prefix: |
  FIRST: Find and read all markdown documentation in this project before doing anything else.
  Search for and read: README files (root and subdirectories), CLAUDE.md, AGENTS.md, and all
  files in docs/ or documentation/ directories. Understand the codebase's patterns, conventions,
  and architecture. Only then proceed with your task.

  When spawning sub-agents, explicitly instruct each one to first read all project
  documentation (README files, CLAUDE.md, AGENTS.md, docs/ and documentation/ directories)
  before starting its task.

prompt_suffix: |
  Do not use the "question" tool or any tool requiring user input.
  Stage and commit your changes at the end with a descriptive message.

modes:
  - name: quality
    prompt: |
      Good documentation is accurate, navigable, and clear. It respects readers'
      time, uses consistent terminology, and doesn't repeat itself unnecessarily.

      Documentation that serves readers well:
      - Matches what the code actually does
      - Has clear structure that's easy to navigate
      - Uses precise, concise prose
      - Avoids redundancy that adds no value

      Before editing any documentation, read the corresponding source code to verify
      current behavior.

      Focus on improvements that readers will notice. A few meaningful fixes—
      correcting inaccuracies, clarifying confusing sections—are better than
      many minor tweaks.

      Leave alone what already works. "No changes needed" is a valid outcome.

      **After completing your changes**, orchestrate a verification:

      1. Spawn a sub-agent to review your work. Give it:
         - This task description (documentation quality improvement)
         - The files you modified
         - Instruction to check: do changes match the goals? Anything missed?
           Opportunities to simplify?

      2. Spawn another sub-agent. Give it:
         - This task description
         - Your changes (via git diff)
         - The full feedback from step 1
         - Instruction to identify which feedback is genuinely applicable vs
           over-defensive, speculative, or based on misunderstanding

      3. Address only the filtered feedback from step 2. Make changes where
         warranted, preserve the original scope. Do not commit until this step.

  - name: coherence
    prompt: |
      Coherent documentation reads as a unified whole. Topics appear once, in the
      right place. Readers can navigate without encountering redundancy or gaps.

      Signs of coherence problems:
      - Significant overlap between files (consolidate)
      - Same thing said different ways in different places (pick one)
      - Content that doesn't belong in its current location (move or remove)
      - Confusing structure that makes navigation difficult (reorganize)

      Deletion is value. Removing redundant content is as important as improving
      what remains. A smaller, well-organized documentation set serves readers
      better than a comprehensive but scattered one.

      **After completing your changes**, orchestrate verification:

      1. Spawn a sub-agent to review your work. Give it:
         - This task (documentation coherence)
         - The files you modified
         - Instruction to check: did consolidation lose important content?
           Is navigation clearer? Any further consolidation possible?

      2. Spawn a filter sub-agent. Give it the verification feedback and ask:
         which concerns are genuine vs over-cautious?

      3. Address filtered feedback, then commit.
