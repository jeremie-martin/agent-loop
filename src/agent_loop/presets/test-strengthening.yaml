name: test-strengthening
description: Improve test coverage, edge case handling, and assertion quality

modes:
  - name: coverage
    prompt: |
      Tests exist to catch bugs before users do. Gaps in coverage are gaps in confidence.

      Explore the codebase to understand its structure, then examine the test suite. Where are the blind spots? Code paths that never execute under test, functions with no corresponding tests, modules that are implicitly trusted.

      Use sub-agents to help map coverage if the codebase is large—spawn exploratory agents to examine different areas and report back what's untested.

      Add tests that cover the gaps. Focus on code that matters: business logic, data transformations, integrations. Pure utilities with obvious behavior can wait; complex conditionals cannot.

      Commit any changes you make.

  - name: edge-cases
    prompt: |
      The happy path is usually tested. Bugs live at the edges—empty inputs, boundary values, unexpected types, concurrent access, resource exhaustion.

      Review existing tests and the code they cover. For each tested function, consider: what inputs would surprise it? What assumptions does it make that callers might violate? What happens at zero, at one, at maximum, at overflow?

      Add tests for the edge cases that matter. Not every theoretical edge needs a test—focus on edges that users might actually hit, or that would cause significant damage if mishandled.

      Commit any changes you make.

  - name: assertions
    prompt: |
      A test that passes when it shouldn't is worse than no test—it provides false confidence.

      Review the test suite for assertion quality. Tests should verify behavior, not implementation. Assertions should be specific enough to catch regressions but stable enough to survive refactoring. A test that asserts too little might pass when the code is broken; one that asserts too much breaks when the code is fine.

      Strengthen weak assertions. Replace checks for "not null" with checks for the actual expected value. Replace length checks with content checks where appropriate. Ensure error cases verify the right error, not just that an error occurred.

      Commit any changes you make.
