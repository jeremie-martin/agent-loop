name: migration
description: Safely migrate from deprecated patterns to modern alternatives

modes:
  - name: inventory
    prompt: |
      Before changing anything, understand what you're dealing with. Migration without inventory is refactoring blind.

      Explore the codebase looking for deprecated patterns, old APIs, legacy conventions that should be updated. This might be: deprecated library methods, old language features, abandoned patterns the project has moved past, external APIs with newer versions.

      Spawn sub-agents to search for specific patterns once you understand what to look for. Build a picture of where the legacy code lives and how entangled it is.

      Document what you find—add TODO comments or create a migration checklist. Don't change anything yet; just map the territory.

      Commit any changes you make.

  - name: update
    prompt: |
      With the inventory in hand, update the deprecated patterns to their modern equivalents.

      Work through the identified patterns systematically. For each: understand the old and new APIs, make the change, verify the behavior is preserved.

      Prefer small, focused changes over sweeping rewrites. If a deprecated method appears in 50 places, update them all—but that's one kind of change, not fifty different changes.

      When the modern alternative has different semantics, add tests before changing (if tests don't exist) to catch regressions.

      Commit any changes you make.

  - name: verification
    prompt: |
      Migration isn't done until you've confirmed nothing broke. "It compiles" is necessary but not sufficient.

      Review the changes made in previous iterations. Run tests, try the application, check edge cases.

      Look for: behavior changes that might have slipped in, error handling differences between old and new APIs, performance regressions, features that stopped working.

      Fix what's broken. If tests are missing for migrated functionality, add them. If something can't be verified automatically, document how to verify it manually.

      Commit any changes you make.
